$$
x 
\xrightarrow{Linear(W,b),\; \frac{\partial z_i}{\partial W_{ij}} = x_j,\; \frac{\partial z_i}{\partial x_j} = W_{ij}} 
z_i = \sum_j W_{ij} x_j + b_i
\xrightarrow{\sigma,\; \frac{\partial h_i}{\partial z_i}=\sigma'(z_i)} 
h_i
\xrightarrow{Linear(W_2,b_2),\; \frac{\partial z_{\text{out},k}}{\partial h_i}=W_{2,ki}} 
z_{\text{out},k} = \sum_i W_{2,ki} h_i + b_{2,k}
\xrightarrow{softmax,\; \frac{\partial L}{\partial z_{\text{out},k}} = \hat{y}_k - y_k} 
\hat{y}_k
\xrightarrow{loss} 
L
$$
